// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package cloudamqp

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi-cloudamqp/sdk/v3/go/cloudamqp/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// This resource allows you to add, update or remove a swebhook for a specific vhost and queue.
//
// Only available for dedicated subscription plans.
//
// ## Example Usage
//
// <details>
//
//	<summary>
//	   <b>
//	     <i>Enable webhook from </i>
//	     <a href="https://github.com/cloudamqp/terraform-provider-cloudamqp/releases/tag/v1.30.0">v1.30.0</a>
//	   </b>
//	 </summary>
//
// Support to updating the resource which makes the argument no longer require `ForceNew` behaviour.
// The argument `retryInterval` have also been removed.
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-cloudamqp/sdk/v3/go/cloudamqp"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := cloudamqp.NewWebhook(ctx, "webhook_queue", &cloudamqp.WebhookArgs{
//				InstanceId:  pulumi.Any(instance.Id),
//				Vhost:       pulumi.Any(instance.Vhost),
//				Queue:       pulumi.String("webhook-queue"),
//				WebhookUri:  pulumi.String("https://example.com/webhook?key=secret"),
//				Concurrency: pulumi.Int(5),
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// </details>
//
// <details>
//
//	<summary>
//	   <b>
//	     <i>Enable webhook before v1.30.0</i>
//	   </b>
//	 </summary>
//
// For more information see below versions section.
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-cloudamqp/sdk/v3/go/cloudamqp"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := cloudamqp.NewWebhook(ctx, "webhook_queue", &cloudamqp.WebhookArgs{
//				InstanceId:    pulumi.Any(instance.Id),
//				Vhost:         pulumi.Any(instance.Vhost),
//				Queue:         pulumi.String("webhook-queue"),
//				WebhookUri:    pulumi.String("https://example.com/webhook?key=secret"),
//				RetryInterval: 5,
//				Concurrency:   pulumi.Int(5),
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// </details>
//
// ## Dependency
//
// This resource depends on CloudAMQP instance identifier, `cloudamqp_instance.instance.id`.
//
// ## Versions
//
// # Information for older versions
//
// <details>
//
//	<summary>
//	  <i>Before v1.30.0</i>
//	</summary>
//
//	Versions before v1.30.0 doesn't support updating the resource, therefore all arguments using the
//	`ForceNew` behaviour. Any changes to an argument will destroy and re-create the resource. The
//	argument `retryInterval` is set to required, even if it's no longer supported in the backend.
//
//	<b>Example Usage</b>
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-cloudamqp/sdk/v3/go/cloudamqp"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//	  pulumi.Run(func(ctx *pulumi.Context) error {
//	      _, err := cloudamqp.NewWebhook(ctx, "webhook_queue", &cloudamqp.WebhookArgs{
//	          InstanceId:    pulumi.Any(instance.Id),
//	          Vhost:         pulumi.Any(instance.Vhost),
//	          Queue:         pulumi.String("webhook-queue"),
//	          WebhookUri:    pulumi.String("https://example.com/webhook?key=secret"),
//	          RetryInterval: 5,
//	          Concurrency:   pulumi.Int(5),
//	      })
//	      if err != nil {
//	          return err
//	      }
//	      return nil
//	  })
//	}
//
// ```
//
//	**Argument Reference**
//
//	The following arguments are supported:
//
//	> * `instanceId`     - (Required/ForceNew) The CloudAMQP instance ID.
//
// > * `vhost`           - (Required/ForceNew) The vhost the queue resides in.
// > * `queue`           - (Required/ForceNew) A (durable) queue on your RabbitMQ instance.
// > * `webhookUri`     - (Required/ForceNew) A POST request will be made for each message in the
// >                             queue to this endpoint.
// > * `retryInterval`  - (Required/ForceNew) How often we retry if your endpoint fails (in seconds).
// > * `concurrency`     - (Required/ForceNew) Max simultaneous requests to the endpoint.
//
// </details>
//
// [CloudAMQP API list webhooks]: https://docs.cloudamqp.com/instance-api.html#tag/webhooks/get/webhooks
type Webhook struct {
	pulumi.CustomResourceState

	// Max simultaneous requests to the endpoint.
	Concurrency pulumi.IntOutput `pulumi:"concurrency"`
	// The CloudAMQP instance ID.
	InstanceId pulumi.IntOutput `pulumi:"instanceId"`
	// A (durable) queue on your RabbitMQ instance.
	Queue pulumi.StringOutput `pulumi:"queue"`
	// Configurable sleep time in seconds between retries for webhook
	Sleep pulumi.IntOutput `pulumi:"sleep"`
	// Configurable timeout time in seconds for webhook
	Timeout pulumi.IntOutput `pulumi:"timeout"`
	// The vhost the queue resides in.
	Vhost pulumi.StringOutput `pulumi:"vhost"`
	// A POST request will be made for each message in the queue to this
	// endpoint.
	WebhookUri pulumi.StringOutput `pulumi:"webhookUri"`
}

// NewWebhook registers a new resource with the given unique name, arguments, and options.
func NewWebhook(ctx *pulumi.Context,
	name string, args *WebhookArgs, opts ...pulumi.ResourceOption) (*Webhook, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.Concurrency == nil {
		return nil, errors.New("invalid value for required argument 'Concurrency'")
	}
	if args.InstanceId == nil {
		return nil, errors.New("invalid value for required argument 'InstanceId'")
	}
	if args.Queue == nil {
		return nil, errors.New("invalid value for required argument 'Queue'")
	}
	if args.Vhost == nil {
		return nil, errors.New("invalid value for required argument 'Vhost'")
	}
	if args.WebhookUri == nil {
		return nil, errors.New("invalid value for required argument 'WebhookUri'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource Webhook
	err := ctx.RegisterResource("cloudamqp:index/webhook:Webhook", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetWebhook gets an existing Webhook resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetWebhook(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *WebhookState, opts ...pulumi.ResourceOption) (*Webhook, error) {
	var resource Webhook
	err := ctx.ReadResource("cloudamqp:index/webhook:Webhook", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering Webhook resources.
type webhookState struct {
	// Max simultaneous requests to the endpoint.
	Concurrency *int `pulumi:"concurrency"`
	// The CloudAMQP instance ID.
	InstanceId *int `pulumi:"instanceId"`
	// A (durable) queue on your RabbitMQ instance.
	Queue *string `pulumi:"queue"`
	// Configurable sleep time in seconds between retries for webhook
	Sleep *int `pulumi:"sleep"`
	// Configurable timeout time in seconds for webhook
	Timeout *int `pulumi:"timeout"`
	// The vhost the queue resides in.
	Vhost *string `pulumi:"vhost"`
	// A POST request will be made for each message in the queue to this
	// endpoint.
	WebhookUri *string `pulumi:"webhookUri"`
}

type WebhookState struct {
	// Max simultaneous requests to the endpoint.
	Concurrency pulumi.IntPtrInput
	// The CloudAMQP instance ID.
	InstanceId pulumi.IntPtrInput
	// A (durable) queue on your RabbitMQ instance.
	Queue pulumi.StringPtrInput
	// Configurable sleep time in seconds between retries for webhook
	Sleep pulumi.IntPtrInput
	// Configurable timeout time in seconds for webhook
	Timeout pulumi.IntPtrInput
	// The vhost the queue resides in.
	Vhost pulumi.StringPtrInput
	// A POST request will be made for each message in the queue to this
	// endpoint.
	WebhookUri pulumi.StringPtrInput
}

func (WebhookState) ElementType() reflect.Type {
	return reflect.TypeOf((*webhookState)(nil)).Elem()
}

type webhookArgs struct {
	// Max simultaneous requests to the endpoint.
	Concurrency int `pulumi:"concurrency"`
	// The CloudAMQP instance ID.
	InstanceId int `pulumi:"instanceId"`
	// A (durable) queue on your RabbitMQ instance.
	Queue string `pulumi:"queue"`
	// Configurable sleep time in seconds between retries for webhook
	Sleep *int `pulumi:"sleep"`
	// Configurable timeout time in seconds for webhook
	Timeout *int `pulumi:"timeout"`
	// The vhost the queue resides in.
	Vhost string `pulumi:"vhost"`
	// A POST request will be made for each message in the queue to this
	// endpoint.
	WebhookUri string `pulumi:"webhookUri"`
}

// The set of arguments for constructing a Webhook resource.
type WebhookArgs struct {
	// Max simultaneous requests to the endpoint.
	Concurrency pulumi.IntInput
	// The CloudAMQP instance ID.
	InstanceId pulumi.IntInput
	// A (durable) queue on your RabbitMQ instance.
	Queue pulumi.StringInput
	// Configurable sleep time in seconds between retries for webhook
	Sleep pulumi.IntPtrInput
	// Configurable timeout time in seconds for webhook
	Timeout pulumi.IntPtrInput
	// The vhost the queue resides in.
	Vhost pulumi.StringInput
	// A POST request will be made for each message in the queue to this
	// endpoint.
	WebhookUri pulumi.StringInput
}

func (WebhookArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*webhookArgs)(nil)).Elem()
}

type WebhookInput interface {
	pulumi.Input

	ToWebhookOutput() WebhookOutput
	ToWebhookOutputWithContext(ctx context.Context) WebhookOutput
}

func (*Webhook) ElementType() reflect.Type {
	return reflect.TypeOf((**Webhook)(nil)).Elem()
}

func (i *Webhook) ToWebhookOutput() WebhookOutput {
	return i.ToWebhookOutputWithContext(context.Background())
}

func (i *Webhook) ToWebhookOutputWithContext(ctx context.Context) WebhookOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WebhookOutput)
}

// WebhookArrayInput is an input type that accepts WebhookArray and WebhookArrayOutput values.
// You can construct a concrete instance of `WebhookArrayInput` via:
//
//	WebhookArray{ WebhookArgs{...} }
type WebhookArrayInput interface {
	pulumi.Input

	ToWebhookArrayOutput() WebhookArrayOutput
	ToWebhookArrayOutputWithContext(context.Context) WebhookArrayOutput
}

type WebhookArray []WebhookInput

func (WebhookArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*Webhook)(nil)).Elem()
}

func (i WebhookArray) ToWebhookArrayOutput() WebhookArrayOutput {
	return i.ToWebhookArrayOutputWithContext(context.Background())
}

func (i WebhookArray) ToWebhookArrayOutputWithContext(ctx context.Context) WebhookArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WebhookArrayOutput)
}

// WebhookMapInput is an input type that accepts WebhookMap and WebhookMapOutput values.
// You can construct a concrete instance of `WebhookMapInput` via:
//
//	WebhookMap{ "key": WebhookArgs{...} }
type WebhookMapInput interface {
	pulumi.Input

	ToWebhookMapOutput() WebhookMapOutput
	ToWebhookMapOutputWithContext(context.Context) WebhookMapOutput
}

type WebhookMap map[string]WebhookInput

func (WebhookMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*Webhook)(nil)).Elem()
}

func (i WebhookMap) ToWebhookMapOutput() WebhookMapOutput {
	return i.ToWebhookMapOutputWithContext(context.Background())
}

func (i WebhookMap) ToWebhookMapOutputWithContext(ctx context.Context) WebhookMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(WebhookMapOutput)
}

type WebhookOutput struct{ *pulumi.OutputState }

func (WebhookOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**Webhook)(nil)).Elem()
}

func (o WebhookOutput) ToWebhookOutput() WebhookOutput {
	return o
}

func (o WebhookOutput) ToWebhookOutputWithContext(ctx context.Context) WebhookOutput {
	return o
}

// Max simultaneous requests to the endpoint.
func (o WebhookOutput) Concurrency() pulumi.IntOutput {
	return o.ApplyT(func(v *Webhook) pulumi.IntOutput { return v.Concurrency }).(pulumi.IntOutput)
}

// The CloudAMQP instance ID.
func (o WebhookOutput) InstanceId() pulumi.IntOutput {
	return o.ApplyT(func(v *Webhook) pulumi.IntOutput { return v.InstanceId }).(pulumi.IntOutput)
}

// A (durable) queue on your RabbitMQ instance.
func (o WebhookOutput) Queue() pulumi.StringOutput {
	return o.ApplyT(func(v *Webhook) pulumi.StringOutput { return v.Queue }).(pulumi.StringOutput)
}

// Configurable sleep time in seconds between retries for webhook
func (o WebhookOutput) Sleep() pulumi.IntOutput {
	return o.ApplyT(func(v *Webhook) pulumi.IntOutput { return v.Sleep }).(pulumi.IntOutput)
}

// Configurable timeout time in seconds for webhook
func (o WebhookOutput) Timeout() pulumi.IntOutput {
	return o.ApplyT(func(v *Webhook) pulumi.IntOutput { return v.Timeout }).(pulumi.IntOutput)
}

// The vhost the queue resides in.
func (o WebhookOutput) Vhost() pulumi.StringOutput {
	return o.ApplyT(func(v *Webhook) pulumi.StringOutput { return v.Vhost }).(pulumi.StringOutput)
}

// A POST request will be made for each message in the queue to this
// endpoint.
func (o WebhookOutput) WebhookUri() pulumi.StringOutput {
	return o.ApplyT(func(v *Webhook) pulumi.StringOutput { return v.WebhookUri }).(pulumi.StringOutput)
}

type WebhookArrayOutput struct{ *pulumi.OutputState }

func (WebhookArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*Webhook)(nil)).Elem()
}

func (o WebhookArrayOutput) ToWebhookArrayOutput() WebhookArrayOutput {
	return o
}

func (o WebhookArrayOutput) ToWebhookArrayOutputWithContext(ctx context.Context) WebhookArrayOutput {
	return o
}

func (o WebhookArrayOutput) Index(i pulumi.IntInput) WebhookOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *Webhook {
		return vs[0].([]*Webhook)[vs[1].(int)]
	}).(WebhookOutput)
}

type WebhookMapOutput struct{ *pulumi.OutputState }

func (WebhookMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*Webhook)(nil)).Elem()
}

func (o WebhookMapOutput) ToWebhookMapOutput() WebhookMapOutput {
	return o
}

func (o WebhookMapOutput) ToWebhookMapOutputWithContext(ctx context.Context) WebhookMapOutput {
	return o
}

func (o WebhookMapOutput) MapIndex(k pulumi.StringInput) WebhookOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *Webhook {
		return vs[0].(map[string]*Webhook)[vs[1].(string)]
	}).(WebhookOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*WebhookInput)(nil)).Elem(), &Webhook{})
	pulumi.RegisterInputType(reflect.TypeOf((*WebhookArrayInput)(nil)).Elem(), WebhookArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*WebhookMapInput)(nil)).Elem(), WebhookMap{})
	pulumi.RegisterOutputType(WebhookOutput{})
	pulumi.RegisterOutputType(WebhookArrayOutput{})
	pulumi.RegisterOutputType(WebhookMapOutput{})
}
